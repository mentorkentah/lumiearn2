<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login | LUMIEARN</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#0a3f99,#0050ff);
  font-family:Arial, Helvetica, sans-serif;
}

.login-card{
  background:#fff;
  width:360px;
  max-width:92%;
  padding:25px 20px;
  border-radius:16px;
  box-shadow:0 8px 25px rgba(0,0,0,0.3);
  text-align:center;
}

.logo{
  width:200px;
  margin-bottom:10px;
}

h2{
  color:#0050ff;
  margin-bottom:15px;
}

.input-box{
  margin-bottom:15px;
  text-align:left;
}

.input-box label{
  font-size:13px;
  font-weight:bold;
  color:#333;
}

.input-box input{
  width:100%;
  height:40px;
  padding:0 10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:5px;
  font-size:14px;
  outline:none;
}

.input-box input:focus{
  border-color:#0050ff;
}

.btn{
  width:100%;
  height:45px;
  border:none;
  border-radius:12px;
  background:#0050ff;
  color:#fff;
  font-size:15px;
  font-weight:bold;
  cursor:pointer;
  margin-top:5px;
}

.btn:hover{
  background:#003bb5;
}

.register-link{
  margin-top:15px;
  font-size:13px;
}

.register-link a{
  color:#0050ff;
  text-decoration:none;
  font-weight:bold;
}

/* Remove white autofill background */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px #ffffff inset !important;
  -webkit-text-fill-color: #000 !important;
  transition: background-color 5000s ease-in-out 0s;
}
</style>
</head>
<body>

<div class="login-card">
  <img src="https://lumiearn.vercel.app/logo.png" class="logo" alt="LUMIEARN">

  <h2>Login to Your Account</h2>

  <form id="loginForm">

    <div class="input-box">
      <label>Username / Email / Phone</label>
      <input type="text" id="loginInput" required>
    </div>

    <div class="input-box">
      <label>Password</label>
      <input type="password" id="password" required>
    </div>

    <button type="submit" class="btn">
      <i class="fa-solid fa-right-to-bracket"></i> Login
    </button>

  </form>

  <div class="register-link">
    Donâ€™t have an account? <a href="register.html">Register</a>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const form = document.getElementById("loginForm");

  form.addEventListener("submit", function(e){
    e.preventDefault();

    const input = document.getElementById("loginInput").value.trim().toLowerCase();
    const password = document.getElementById("password").value;

    let foundUser = null;

    // Search all registered users
    for(let i = 0; i < localStorage.length; i++){
      const key = localStorage.key(i);

      if(key.startsWith("LUMIEARN_USER_")){
        const user = JSON.parse(localStorage.getItem(key));

        if(
          user.username.toLowerCase() === input ||
          user.email.toLowerCase() === input ||
          user.phone === input
        ){
          foundUser = user;
          break;
        }
      }
    }

    if(!foundUser){
      alert("User not found. Please register first.");
      return;
    }

    if(foundUser.password !== password){
      alert("Incorrect password.");
      return;
    }

    // Save logged in session
    localStorage.setItem("LUMIEARN_LOGGED_IN", foundUser.username);

    alert("Login successful!");

    if(foundUser.paid === true){
      window.location.href = "dashboard.html";
    } else {
      window.location.href = "payment.html";
    }

  });

});
</script>

</body>
</html>